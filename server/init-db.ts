import Database from 'better-sqlite3';
import bcrypt from 'bcryptjs';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const db = new Database(join(__dirname, 'furniture.db'));

// –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
db.exec(`
  -- –¢–∞–±–ª–∏—Ü–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
  CREATE TABLE IF NOT EXISTS categories (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    slug TEXT UNIQUE NOT NULL
  );

  -- –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤
  CREATE TABLE IF NOT EXISTS products (
    id TEXT PRIMARY KEY,
    title TEXT NOT NULL,
    price TEXT NOT NULL,
    description TEXT,
    characteristics TEXT,
    category_id TEXT,
    FOREIGN KEY (category_id) REFERENCES categories(id)
  );

  -- –¢–∞–±–ª–∏—Ü–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤
  CREATE TABLE IF NOT EXISTS product_images (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    product_id TEXT NOT NULL,
    image_url TEXT NOT NULL,
    sort_order INTEGER DEFAULT 0,
    FOREIGN KEY (product_id) REFERENCES products(id)
  );

  -- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    phone TEXT,
    email TEXT UNIQUE NOT NULL,
    password_hash TEXT NOT NULL,
    subscribe_news INTEGER DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP
  );

  -- –¢–∞–±–ª–∏—Ü–∞ —Å–µ—Å—Å–∏–π (–¥–ª—è –∫—É–∫–∏)
  CREATE TABLE IF NOT EXISTS sessions (
    id TEXT PRIMARY KEY,
    user_id INTEGER NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    expires_at DATETIME NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id)
  );

  -- –¢–∞–±–ª–∏—Ü–∞ –æ—Ç–∑—ã–≤–æ–≤
  CREATE TABLE IF NOT EXISTS reviews (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    product_id TEXT NOT NULL,
    user_name TEXT NOT NULL,
    user_email TEXT NOT NULL,
    rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),
    review_text TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (product_id) REFERENCES products(id)
  );
`);

// –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
const categories = [
  { id: 'soft', name: '–ú—è–≥–∫–∞—è –º–µ–±–µ–ª—å', slug: 'soft' },
  { id: 'bedroom', name: '–°–ø–∞–ª—å–Ω—è', slug: 'bedroom' },
  { id: 'storage', name: '–°–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è', slug: 'storage' }
];

const insertCategory = db.prepare(`
  INSERT OR REPLACE INTO categories (id, name, slug) VALUES (?, ?, ?)
`);

for (const cat of categories) {
  insertCategory.run(cat.id, cat.name, cat.slug);
}

// –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - —Ç–æ–≤–∞—Ä—ã
const products = [
  {
    id: 'sofa',
    title: '–î–∏–≤–∞–Ω ¬´–¥–∏—Å–ö–æ–º—Ñ–æ—Ä—Ç¬ª',
    price: '39 900 ‚ÇΩ',
    description: '–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–≤–∞–Ω —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ ¬´–µ–≤—Ä–æ–∫–Ω–∏–∂–∫–∞¬ª. –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –æ—Ç–¥—ã—Ö–∞ –∏ —Å–Ω–∞. –ü—Ä–æ—Å—Ç–æ—Ä–Ω–æ–µ —Å–ø–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å—Å—è –¥–≤—É–º –≤–∑—Ä–æ—Å–ª—ã–º. –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ–±–∏–≤–∫–∞ –∏–∑ –≤–µ–ª—é—Ä–∞ –ø—Ä–µ–º–∏—É–º-–∫–ª–∞—Å—Å–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ –∏—Å—Ç–∏—Ä–∞–Ω–∏—é –∏ –ª–µ–≥–∫–æ —á–∏—Å—Ç–∏—Ç—Å—è. –ù–∞–¥—ë–∂–Ω—ã–π –∫–∞—Ä–∫–∞—Å –∏–∑ –º–∞—Å—Å–∏–≤–∞ –¥–µ—Ä–µ–≤–∞ –ø—Ä–æ—Å–ª—É–∂–∏—Ç –¥–æ–ª–≥–∏–µ –≥–æ–¥—ã.',
    characteristics: '–†–∞–∑–º–µ—Ä –≤ —Å–æ–±—Ä–∞–Ω–Ω–æ–º –≤–∏–¥–µ: 230 √ó 95 √ó 95 —Å–º; –°–ø–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ: 200 √ó 145 —Å–º; –ú–µ—Ö–∞–Ω–∏–∑–º: –µ–≤—Ä–æ–∫–Ω–∏–∂–∫–∞; –û–±–∏–≤–∫–∞: –≤–µ–ª—é—Ä –ø—Ä–µ–º–∏—É–º-–∫–ª–∞—Å—Å–∞; –ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ: –ø—Ä—É–∂–∏–Ω–Ω—ã–π –±–ª–æ–∫ + –ü–ü–£; –ö–∞—Ä–∫–∞—Å: –º–∞—Å—Å–∏–≤ —Å–æ—Å–Ω—ã –∏ –±–µ—Ä—ë–∑—ã; –¶–≤–µ—Ç: —Å–µ—Ä—ã–π –≥—Ä–∞—Ñ–∏—Ç / –±–µ–∂–µ–≤—ã–π –ª–µ–Ω; –ì–∞—Ä–∞–Ω—Ç–∏—è: 24 –º–µ—Å—è—Ü–∞',
    category_id: 'soft',
    images: [
      '/img/beds_and_sofa/Main_sofa.png',
      '/img/beds_and_sofa/Big_sofa.png',
      '/img/beds_and_sofa/Med_sofa.png',
      '/img/beds_and_sofa/Small_sofa.png'
    ]
  },
  {
    id: 'chair',
    title: '–ö—Ä–µ—Å–ª–æ ¬´–≠–ª–µ–≥–∞–Ω—Å¬ª',
    price: '24 900 ‚ÇΩ',
    description: '–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω–æ–µ –∫—Ä–µ—Å–ª–æ —Å –º—è–≥–∫–∏–º –Ω–∞–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å–ø–∏–Ω—ã –∏ –ø–æ—è—Å–Ω–∏—Ü—ã. –®–∏—Ä–æ–∫–∏–µ –ø–æ–¥–ª–æ–∫–æ—Ç–Ω–∏–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç –∫–æ–º—Ñ–æ—Ä—Ç–∞ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º —Å–∏–¥–µ–Ω–∏–∏. –î–æ—Å—Ç—É–ø–Ω–æ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ü–≤–µ—Ç–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏—è—Ö: –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–µ—Ä—ã–π, –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–π –∑–µ–ª—ë–Ω—ã–π –∏ —è—Ä–∫–∏–π –∫—Ä–∞—Å–Ω—ã–π. –ò–¥–µ–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –≥–æ—Å—Ç–∏–Ω–æ–π –∏–ª–∏ –∫–∞–±–∏–Ω–µ—Ç–∞.',
    characteristics: '–†–∞–∑–º–µ—Ä: 85 √ó 90 √ó 95 —Å–º; –í—ã—Å–æ—Ç–∞ —Å–∏–¥–µ–Ω—å—è: 45 —Å–º; –û–±–∏–≤–∫–∞: —Ä–æ–≥–æ–∂–∫–∞/–≤–µ–ª—é—Ä; –ù–∞–ø–æ–ª–Ω–∏—Ç–µ–ª—å: –ü–ü–£ –≤—ã—Å–æ–∫–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏; –ö–∞—Ä–∫–∞—Å: —Ñ–∞–Ω–µ—Ä–∞ –±–µ—Ä—ë–∑–æ–≤–∞—è; –ù–æ–∂–∫–∏: –º–∞—Å—Å–∏–≤ –±—É–∫–∞; –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: 120 –∫–≥',
    category_id: 'soft',
    images: [
      '/img/chairs_and_desc/main_chair.png',
      '/img/chairs_and_desc/chair34.png',
      '/img/chairs_and_desc/green_chair.png',
      '/img/chairs_and_desc/red_chair.png'
    ]
  },
  {
    id: 'sofa2',
    title: '–î–∏–≤–∞–Ω ¬´–ü—Ä–µ—Å—Ç–∏–∂¬ª',
    price: '45 900 ‚ÇΩ',
    description: '–ë–æ–ª—å—à–æ–π —É–≥–ª–æ–≤–æ–π –¥–∏–≤–∞–Ω –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ä–Ω–æ–π –≥–æ—Å—Ç–∏–Ω–æ–π. –í–º–µ—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–π –∏ –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π –¥–ª—è –≤—Å–µ–π —Å–µ–º—å–∏. –ú–æ–¥—É–ª—å–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–æ–¥ —Ä–∞–∑–º–µ—Ä—ã –ø–æ–º–µ—â–µ–Ω–∏—è. –ì–ª—É–±–æ–∫–∏–µ –º—è–≥–∫–∏–µ —Å–∏–¥–µ–Ω—å—è –∏ –≤—ã—Å–æ–∫–∞—è —Å–ø–∏–Ω–∫–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∫–æ–º—Ñ–æ—Ä—Ç. –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —è—â–∏–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–µ–ª—å—è ‚Äî –ø—Ä–∞–∫—Ç–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞.',
    characteristics: '–†–∞–∑–º–µ—Ä: 290 √ó 180 √ó 95 —Å–º; –°–ø–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ: 200 √ó 160 —Å–º; –ú–µ—Ö–∞–Ω–∏–∑–º: –¥–µ–ª—å—Ñ–∏–Ω; –û–±–∏–≤–∫–∞: —Ä–æ–≥–æ–∂–∫–∞; –ù–∞–ø–æ–ª–Ω–µ–Ω–∏–µ: –ø—Ä—É–∂–∏–Ω–Ω—ã–π –±–ª–æ–∫ ¬´–ë–æ–Ω–Ω–µ–ª—å¬ª; –Ø—â–∏–∫ –¥–ª—è –±–µ–ª—å—è: –µ—Å—Ç—å; –£–≥–æ–ª: —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π',
    category_id: 'soft',
    images: ['/img/beds_and_sofa/Big_sofa.png']
  },
  {
    id: 'bed',
    title: '–ö—Ä–æ–≤–∞—Ç—å ¬´–†–æ–Ω–¥–∞ –ö–†-160¬ª',
    price: '32 900 ‚ÇΩ',
    description: '–°—Ç–∏–ª—å–Ω–∞—è –∫—Ä–æ–≤–∞—Ç—å –≤ —Å—Ç–∏–ª–µ –º–∏–Ω–∏–º–∞–ª–∏–∑–º —Å –æ—Ä—Ç–æ–ø–µ–¥–∏—á–µ—Å–∫–∏–º –æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º. –í—ã–±–æ—Ä –∏–∑ 4 —Ü–≤–µ—Ç–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–æ–±—Ä–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–¥ –≤–∞—à –∏–Ω—Ç–µ—Ä—å–µ—Ä. –ü—Ä–æ—á–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–∑ –õ–î–°–ü –≤—ã–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –¥–æ 200 –∫–≥. –í—ã—Å–æ–∫–æ–µ –∏–∑–≥–æ–ª–æ–≤—å–µ —Å–æ–∑–¥–∞—ë—Ç —É—é—Ç–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –∏ —É–¥–æ–±–Ω–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –ø–µ—Ä–µ–¥ —Å–Ω–æ–º. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–∞—Ç—Ä–∞—Å–æ–≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤.',
    characteristics: '–°–ø–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ: 160 √ó 200 —Å–º; –í—ã—Å–æ—Ç–∞ –∏–∑–≥–æ–ª–æ–≤—å—è: 105 —Å–º; –ú–∞—Ç–µ—Ä–∏–∞–ª: –õ–î–°–ü 16 –º–º; –û—Å–Ω–æ–≤–∞–Ω–∏–µ: –æ—Ä—Ç–æ–ø–µ–¥–∏—á–µ—Å–∫–æ–µ –Ω–∞ –ª–∞–º–µ–ª—è—Ö; –¶–≤–µ—Ç–∞: –±–µ–ª—ã–π, –¥—É–± —Å–æ–Ω–æ–º–∞, –≤–µ–Ω–≥–µ, —Å–µ—Ä—ã–π; –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: 200 –∫–≥',
    category_id: 'bedroom',
    images: [
      '/img/beds_and_sofa/white_bed1.png',
      '/img/beds_and_sofa/white_bed2.png',
      '/img/beds_and_sofa/white_bed3.png'
    ]
  },
  {
    id: 'bed2',
    title: '–ö—Ä–æ–≤–∞—Ç—å ¬´–í–µ–Ω–µ—Ü–∏—è –ö–†-180¬ª',
    price: '38 900 ‚ÇΩ',
    description: '–≠–ª–µ–≥–∞–Ω—Ç–Ω–∞—è –∫—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä–∞ King Size. –ü—Ä–æ—á–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–∑ –º–∞—Å—Å–∏–≤–∞ –∏ –õ–î–°–ü –ø—Ä–µ–º–∏—É–º-–∫–ª–∞—Å—Å–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å. –ú—è–≥–∫–æ–µ –∏–∑–≥–æ–ª–æ–≤—å–µ —Å –∫–∞—Ä–µ—Ç–Ω–æ–π —Å—Ç—è–∂–∫–æ–π –ø—Ä–∏–¥–∞—ë—Ç —Å–ø–∞–ª—å–Ω–µ —Ä–æ—Å–∫–æ—à–Ω—ã–π –≤–∏–¥. –®–∏—Ä–æ–∫–æ–µ —Å–ø–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ 180 —Å–º –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ —Å–Ω–∞ –≤–¥–≤–æ—ë–º. –¢—ë–º–Ω—ã–π —Ü–≤–µ—Ç –∫–æ—Ä–ø—É—Å–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—å–µ—Ä—É –±–ª–∞–≥–æ—Ä–æ–¥—Å—Ç–≤–∞.',
    characteristics: '–°–ø–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ: 180 √ó 200 —Å–º; –í—ã—Å–æ—Ç–∞ –∏–∑–≥–æ–ª–æ–≤—å—è: 120 —Å–º; –ú–∞—Ç–µ—Ä–∏–∞–ª: –õ–î–°–ü + –º–∞—Å—Å–∏–≤; –ò–∑–≥–æ–ª–æ–≤—å–µ: –º—è–≥–∫–æ–µ, —ç–∫–æ–∫–æ–∂–∞; –û—Å–Ω–æ–≤–∞–Ω–∏–µ: –æ—Ä—Ç–æ–ø–µ–¥–∏—á–µ—Å–∫–æ–µ; –¶–≤–µ—Ç: —á—ë—Ä–Ω—ã–π/–≤–µ–Ω–≥–µ; –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: 250 –∫–≥',
    category_id: 'bedroom',
    images: [
      '/img/beds_and_sofa/black_bed1.png',
      '/img/beds_and_sofa/black_bed2.png',
      '/img/beds_and_sofa/black_bed3.png',
      '/img/beds_and_sofa/black_bed4.png'
    ]
  },
  {
    id: 'bed3',
    title: '–ö—Ä–æ–≤–∞—Ç—å ¬´–ö–æ–º—Ñ–æ—Ä—Ç –ö–†-140¬ª',
    price: '27 900 ‚ÇΩ',
    description: '–ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –∫—Ä–æ–≤–∞—Ç—å –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö —Å–ø–∞–ª–µ–Ω. –£–¥–æ–±–Ω–∞—è –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å –¥–≤—É–º—è –≤–º–µ—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–º–∏ —è—â–∏–∫–∞–º–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—Å—Ç–µ–ª—å–Ω–æ–≥–æ –±–µ–ª—å—è –∏ —Å–µ–∑–æ–Ω–Ω—ã—Ö –≤–µ—â–µ–π. –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä 140 —Å–º –ø–æ–¥—Ö–æ–¥–∏—Ç –∫–∞–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞, —Ç–∞–∫ –∏ –¥–ª—è –ø–∞—Ä—ã. –õ–∞–∫–æ–Ω–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω –≤–ø–∏—à–µ—Ç—Å—è –≤ –ª—é–±–æ–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—å–µ—Ä. –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ—É—Ä–Ω–∏—Ç—É—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–ª–∞–≤–Ω–æ–µ –æ—Ç–∫—Ä—ã–≤–∞–Ω–∏–µ —è—â–∏–∫–æ–≤.',
    characteristics: '–°–ø–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ: 140 √ó 200 —Å–º; –Ø—â–∏–∫–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è: 2 —à—Ç.; –ú–∞—Ç–µ—Ä–∏–∞–ª: –õ–î–°–ü 22 –º–º; –û—Å–Ω–æ–≤–∞–Ω–∏–µ: –Ω–∞ –ª–∞–º–µ–ª—è—Ö; –¶–≤–µ—Ç: —Å–≤–µ—Ç–ª—ã–π –¥—É–±; –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: 180 –∫–≥',
    category_id: 'bedroom',
    images: [
      '/img/beds_and_sofa/abed1.png',
      '/img/beds_and_sofa/abed2.png',
      '/img/beds_and_sofa/abed3.png'
    ]
  },
  {
    id: 'wardrobe',
    title: '–®–∫–∞—Ñ ¬´–ü—Ä–∞–∫—Ç–∏–∫¬ª',
    price: '29 900 ‚ÇΩ',
    description: '–í–º–µ—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–π —à–∫–∞—Ñ —Å —Ä–∞–∑–¥–≤–∏–∂–Ω—ã–º–∏ –¥–≤–µ—Ä—è–º–∏. –ò–¥–µ–∞–ª–µ–Ω –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–¥–µ–∂–¥—ã –∏ –ø–æ—Å—Ç–µ–ª—å–Ω–æ–≥–æ –±–µ–ª—å—è. –¢—Ä–∏ —Å–µ–∫—Ü–∏–∏ —Å –ø–æ–ª–∫–∞–º–∏ –∏ —à—Ç–∞–Ω–≥–æ–π –¥–ª—è –≤–µ—à–∞–ª–æ–∫ –ø–æ–∑–≤–æ–ª—è—é—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É–¥–æ–±–Ω–æ. –ó–µ—Ä–∫–∞–ª—å–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ –Ω–∞ –¥–≤–µ—Ä–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç—ã. –¢–∏—Ö–∏–π –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–∑–¥–≤–∏–∂–Ω—ã—Ö –¥–≤–µ—Ä–µ–π –Ω–∞ —Ä–æ–ª–∏–∫–∞—Ö –ø—Ä–æ—Å–ª—É–∂–∏—Ç –¥–æ–ª–≥–∏–µ –≥–æ–¥—ã –±–µ–∑ –∑–∞–º–µ–Ω—ã.',
    characteristics: '–†–∞–∑–º–µ—Ä: 180 √ó 60 √ó 220 —Å–º; –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∫—Ü–∏–π: 3; –î–≤–µ—Ä–∏: —Ä–∞–∑–¥–≤–∏–∂–Ω—ã–µ –Ω–∞ —Ä–æ–ª–∏–∫–∞—Ö; –ó–µ—Ä–∫–∞–ª–æ: –µ—Å—Ç—å; –ú–∞—Ç–µ—Ä–∏–∞–ª: –õ–î–°–ü 16 –º–º; –®—Ç–∞–Ω–≥–∞ –¥–ª—è –≤–µ—à–∞–ª–æ–∫: 2 —à—Ç.; –ü–æ–ª–∫–∏: 6 —à—Ç.; –¶–≤–µ—Ç: –±–µ–ª—ã–π/–¥—É–± —Å–æ–Ω–æ–º–∞',
    category_id: 'storage',
    images: ['/img/wardrobes/wardrobe.png']
  },
  {
    id: 'dresser',
    title: '–ö–æ–º–æ–¥ ¬´–ú–æ–¥–µ—Ä–Ω¬ª',
    price: '18 900 ‚ÇΩ',
    description: '–°—Ç–∏–ª—å–Ω—ã–π –∫–æ–º–æ–¥ —Å 5 –≤—ã–¥–≤–∏–∂–Ω—ã–º–∏ —è—â–∏–∫–∞–º–∏. –ü—Ä–æ—á–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏ –ø–ª–∞–≤–Ω–æ–µ –∑–∞–∫—Ä—ã–≤–∞–Ω–∏–µ –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∏–º —Å –¥–æ–≤–æ–¥—á–∏–∫–∞–º–∏. –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –∫–æ–º–æ–¥ –¥–∞–∂–µ –≤ –Ω–µ–±–æ–ª—å—à–æ–π –∫–æ–º–Ω–∞—Ç–µ. –í–µ—Ä—Ö–Ω—è—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ —Ü–∞—Ä–∞–ø–∏–Ω–∞–º –∏ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –ø–æ–ª–∫–∞ –¥–ª—è –¥–µ–∫–æ—Ä–∞ –∏–ª–∏ —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω —Å –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–º–∏ —Ä—É—á–∫–∞–º–∏.',
    characteristics: '–†–∞–∑–º–µ—Ä: 80 √ó 45 √ó 100 —Å–º; –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è—â–∏–∫–æ–≤: 5; –ù–∞–ø—Ä–∞–≤–ª—è—é—â–∏–µ: —à–∞—Ä–∏–∫–æ–≤—ã–µ —Å –¥–æ–≤–æ–¥—á–∏–∫–æ–º; –ú–∞—Ç–µ—Ä–∏–∞–ª: –õ–î–°–ü 16 –º–º; –†—É—á–∫–∏: –º–µ—Ç–∞–ª–ª, —Ö—Ä–æ–º; –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —è—â–∏–∫: 10 –∫–≥; –¶–≤–µ—Ç: —Ç—ë–º–Ω—ã–π –æ—Ä–µ—Ö',
    category_id: 'storage',
    images: [
      '/img/chairs_and_desc/desc1.png',
      '/img/chairs_and_desc/desc2.png'
    ]
  },
  {
    id: 'dresser2',
    title: '–ö–æ–º–æ–¥ ¬´–ö–ª–∞—Å—Å–∏–∫¬ª',
    price: '21 900 ‚ÇΩ',
    description: '–≠–ª–µ–≥–∞–Ω—Ç–Ω—ã–π –∫–æ–º–æ–¥ –≤ —Å–≤–µ—Ç–ª—ã—Ö —Ç–æ–Ω–∞—Ö. –û—Ç–ª–∏—á–Ω–æ –≤–ø–∏—à–µ—Ç—Å—è –≤ –ª—é–±–æ–π –∏–Ω—Ç–µ—Ä—å–µ—Ä —Å–ø–∞–ª—å–Ω–∏ –∏–ª–∏ –≥–æ—Å—Ç–∏–Ω–æ–π. –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω —Å –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —Å–æ–∑–¥–∞—ë—Ç —É—é—Ç–Ω—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É. –ß–µ—Ç—ã—Ä–µ –≤–º–µ—Å—Ç–∏—Ç–µ–ª—å–Ω—ã—Ö —è—â–∏–∫–∞ —Ä–∞–∑–Ω–æ–π –≥–ª—É–±–∏–Ω—ã –¥–ª—è —É–¥–æ–±–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è. –ò–∑–≥–æ—Ç–æ–≤–ª–µ–Ω –∏–∑ —ç–∫–æ–ª–æ–≥–∏—á–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è. –£—Å—Ç–æ–π—á–∏–≤–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∫—Ä–µ–ø–ª–µ–Ω–∏—è –∫ —Å—Ç–µ–Ω–µ.',
    characteristics: '–†–∞–∑–º–µ—Ä: 90 √ó 50 √ó 95 —Å–º; –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è—â–∏–∫–æ–≤: 4; –ù–∞–ø—Ä–∞–≤–ª—è—é—â–∏–µ: —Ä–æ–ª–∏–∫–æ–≤—ã–µ; –ú–∞—Ç–µ—Ä–∏–∞–ª: –ú–î–§ + –õ–î–°–ü; –ü–æ–∫—Ä—ã—Ç–∏–µ: —ç–º–∞–ª—å; –†—É—á–∫–∏: –∫–µ—Ä–∞–º–∏–∫–∞; –¶–≤–µ—Ç: –±–µ–ª—ã–π/—Å–ª–æ–Ω–æ–≤–∞—è –∫–æ—Å—Ç—å',
    category_id: 'storage',
    images: [
      '/img/chairs_and_desc/w_desc1.png',
      '/img/chairs_and_desc/w_desc2.png'
    ]
  },
  {
    id: 'whitechair',
    title: '–ö—Ä–µ—Å–ª–æ ¬´–°–Ω–µ–∂–æ–∫¬ª',
    price: '22 500 ‚ÇΩ',
    description: '–£—é—Ç–Ω–æ–µ –∫—Ä–µ—Å–ª–æ —Å –º—è–≥–∫–æ–π –æ–±–∏–≤–∫–æ–π. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –æ—Ç–¥—ã—Ö–∞. –û–∫—Ä—É–≥–ª—ã–µ —Ñ–æ—Ä–º—ã –∏ –±–µ–ª–æ—Å–Ω–µ–∂–Ω—ã–π —Ü–≤–µ—Ç —Å–æ–∑–¥–∞—é—Ç –æ—â—É—â–µ–Ω–∏–µ –ª—ë–≥–∫–æ—Å—Ç–∏ –∏ –≤–æ–∑–¥—É—à–Ω–æ—Å—Ç–∏. –ù–∞–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∏–∑ –ø–µ–Ω–æ–ø–æ–ª–∏—É—Ä–µ—Ç–∞–Ω–∞ –≤—ã—Å–æ–∫–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –¥–∞–∂–µ –ø—Ä–∏ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏. –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –∫—Ä–µ—Å–ª–æ –≤ –ª—é–±–æ–º —É–≥–æ–ª–∫–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã. –õ–µ–≥–∫–æ —Å–æ—á–µ—Ç–∞–µ—Ç—Å—è —Å –º–µ–±–µ–ª—å—é –≤ —Å–∫–∞–Ω–¥–∏–Ω–∞–≤—Å–∫–æ–º —Å—Ç–∏–ª–µ.',
    characteristics: '–†–∞–∑–º–µ—Ä: 75 √ó 80 √ó 85 —Å–º; –í—ã—Å–æ—Ç–∞ —Å–∏–¥–µ–Ω—å—è: 42 —Å–º; –û–±–∏–≤–∫–∞: –±—É–∫–ª–µ/–≤–µ–ª—é—Ä; –ù–∞–ø–æ–ª–Ω–∏—Ç–µ–ª—å: –ü–ü–£ 30 –∫–≥/–º¬≥; –ö–∞—Ä–∫–∞—Å: —Ñ–∞–Ω–µ—Ä–∞ + –î–°–ü; –ù–æ–∂–∫–∏: –º–µ—Ç–∞–ª–ª, –ø–æ—Ä–æ—à–∫–æ–≤–∞—è –æ–∫—Ä–∞—Å–∫–∞; –¶–≤–µ—Ç: –±–µ–ª—ã–π/–º–æ–ª–æ—á–Ω—ã–π',
    category_id: 'soft',
    images: ['/img/chairs_and_desc/chair.png']
  }
];

const insertProduct = db.prepare(`
  INSERT OR REPLACE INTO products (id, title, price, description, characteristics, category_id) 
  VALUES (?, ?, ?, ?, ?, ?)
`);

const insertImage = db.prepare(`
  INSERT OR REPLACE INTO product_images (product_id, image_url, sort_order) VALUES (?, ?, ?)
`);

// –û—á–∏—Å—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π
db.exec('DELETE FROM product_images');

for (const product of products) {
  insertProduct.run(
    product.id,
    product.title,
    product.price,
    product.description,
    product.characteristics,
    product.category_id
  );
  
  product.images.forEach((img, idx) => {
    insertImage.run(product.id, img, idx);
  });
}

// –î–æ–±–∞–≤–∏–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const testPassword = bcrypt.hashSync('test123', 10);
const insertUser = db.prepare(`
  INSERT OR IGNORE INTO users (name, phone, email, password_hash, subscribe_news)
  VALUES (?, ?, ?, ?, ?)
`);
insertUser.run('–¢–µ—Å—Ç–æ–≤—ã–π –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', '+7 (999) 123-45-67', 'test@test.ru', testPassword, 0);

// –î–æ–±–∞–≤–∏–º —Ç–µ—Å—Ç–æ–≤—ã–µ –æ—Ç–∑—ã–≤—ã
const insertReview = db.prepare(`
  INSERT OR IGNORE INTO reviews (product_id, user_name, user_email, rating, review_text)
  VALUES (?, ?, ?, ?, ?)
`);

insertReview.run('sofa', '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤', 'ivan@mail.ru', 5, '–û—Ç–ª–∏—á–Ω—ã–π –¥–∏–≤–∞–Ω! –û—á–µ–Ω—å —É–¥–æ–±–Ω—ã–π –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π. –†–µ–∫–æ–º–µ–Ω–¥—É—é –≤—Å–µ–º.');
insertReview.run('sofa', '–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞', 'maria@mail.ru', 4, '–•–æ—Ä–æ—à–∏–π –¥–∏–≤–∞–Ω, –Ω–æ –¥–æ—Å—Ç–∞–≤–∫–∞ –Ω–µ–º–Ω–æ–≥–æ –∑–∞–¥–µ—Ä–∂–∞–ª–∞—Å—å.');
insertReview.run('bed', '–ê–ª–µ–∫—Å–µ–π –ö–æ–∑–ª–æ–≤', 'alex@mail.ru', 5, '–ü—Ä–µ–∫—Ä–∞—Å–Ω–∞—è –∫—Ä–æ–≤–∞—Ç—å, —Å–ø–∏–º –Ω–∞ –Ω–µ–π —É–∂–µ –º–µ—Å—è—Ü - –æ—á–µ–Ω—å –¥–æ–≤–æ–ª—å–Ω—ã!');

db.close();

console.log('‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!');
console.log('üì¶ –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ' + categories.length);
console.log('üì¶ –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–æ–≤–∞—Ä—ã: ' + products.length);
console.log('üë§ –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: test@test.ru / test123');
