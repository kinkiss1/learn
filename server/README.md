# Интерьер-центр - Backend Setup

## Требования
- Node.js 18+ 
- npm или bun

## Структура бэкенда

```
server/
├── package.json       # Зависимости бэкенда
├── init-db.js         # Скрипт инициализации БД
├── index.js           # Express сервер
└── furniture.db       # SQLite база данных (создается автоматически)
```

## Установка и запуск

### 1. Установка зависимостей бэкенда

```bash
cd server
npm install
```

### 2. Инициализация базы данных

```bash
npm run init-db
```

Это создаст файл `furniture.db` с:
- Таблицами: users, sessions, products, categories, product_images, reviews
- Начальными данными: 9 товаров, 3 категории
- Тестовым пользователем: `test@test.ru` / `test123`
- Тестовыми отзывами

### 3. Запуск бэкенд сервера

```bash
npm run dev
```

Сервер запустится на `http://localhost:3001`

### 4. Запуск фронтенда (в другом терминале)

```bash
cd ..
npm run dev
```

Фронтенд запустится на `http://localhost:5173`

## API Эндпоинты

### Авторизация
- `POST /api/auth/register` - Регистрация пользователя
- `POST /api/auth/login` - Вход
- `POST /api/auth/logout` - Выход
- `GET /api/auth/me` - Данные текущего пользователя
- `GET /api/auth/check` - Проверка сессии

### Товары
- `GET /api/products` - Все товары
- `GET /api/products/:id` - Товар по ID
- `GET /api/products/category/:category` - Товары по категории
- `GET /api/products/search/:query` - Поиск товаров

### Категории
- `GET /api/categories` - Все категории с количеством товаров

### Отзывы
- `GET /api/reviews/:productId` - Отзывы для товара
- `POST /api/reviews` - Добавить отзыв

## Реализованный функционал

✅ **1. Рабочие формы**
- Поиск товаров (в header)
- Форма отзывов (на странице товара)
- Форма входа
- Форма регистрации

✅ **2. Регистрация с хешированием пароля**
- Используется bcryptjs для хеширования
- Пароли хранятся в БД только в хешированном виде

✅ **3. Авторизация пользователей**
- Вход по email и паролю
- Проверка хеша пароля

✅ **4. Личный кабинет**
- Страница `/profile` с данными пользователя
- Отображается имя, email, телефон, дата регистрации

✅ **5. Хранение авторизации в cookies**
- Сессия хранится в httpOnly cookie
- Опция "Запомнить меня" (30 дней / 1 день)

✅ **6. Отзывы в базе данных**
- Отзывы сохраняются в таблицу reviews
- Отображаются на странице товара

✅ **7. Товары в базе данных**
- Таблица products с характеристиками
- Таблица product_images для изображений

✅ **8. Категории в БД с товарами**
- Таблица categories
- Связь products.category_id → categories.id

✅ **9. Валидация пароля**
- Минимум 6 символов
- Минимум 1 буква
- Минимум 1 цифра
- Проверка совпадения паролей

## Тестовые данные

После инициализации БД доступны:

**Тестовый пользователь:**
- Email: `test@test.ru`
- Пароль: `test123`

**Категории:**
- Мягкая мебель (soft)
- Спальня (bedroom)
- Системы хранения (storage)

**Товары:** 9 шт. с изображениями и описаниями
